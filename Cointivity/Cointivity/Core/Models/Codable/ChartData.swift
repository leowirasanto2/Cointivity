//
//  Chart.swift
//  Cointivity
//
//  Created by Leo Wirasanto Laia on 25/04/24.
//

import Foundation

struct ChartData: Codable {
    let prices: [[Double]]
    let marketCaps: [[Double]]
    let totalVolumes: [[Double]]
    
    enum CodingKeys: String, CodingKey {
        case prices
        case marketCaps = "market_caps"
        case totalVolumes = "total_volumes"
    }
    
    func getPriceDataPoint() -> [PriceDataPoint] {
        let result = prices.compactMap { data -> PriceDataPoint? in
            guard
                let date = data.first,
                let price = data.last else { return nil }
            let toDate = Date(timeIntervalSince1970: date / 1000)
            return PriceDataPoint(price: price, date: toDate)
        }
        return result
    }
}

struct PriceDataPoint {
    var id = UUID().uuidString
    var price: Double
    var date: Date
}

extension ChartData {
    static let day = "chart-res-one-day"
    static let month = "chart-res-one-month"
    static let week = "chart-res-one-week"
    static let year = "chart-res-one-year"
}


extension PriceDataPoint {
    static func getDummyPriceData() -> [PriceDataPoint] {
        let points = [
            [
                1714369246101,
                62384.9655764537
            ],
            [
                1714369522471,
                62305.188667430884
            ],
            [
                1714369803901,
                62390.108472737855
            ],
            [
                1714370157731,
                62402.594029732805
            ],
            [
                1714370424073,
                62417.64089893215
            ],
            [
                1714370714986,
                62400.754190180654
            ],
            [
                1714371067227,
                62459.58409416119
            ],
            [
                1714371322326,
                62374.37837511641
            ],
            [
                1714371654891,
                62353.91008990393
            ],
            [
                1714371911637,
                62306.087998361385
            ],
            [
                1714372229011,
                62273.49586828458
            ],
            [
                1714372587440,
                62083.54172642469
            ],
            [
                1714372875276,
                62249.565829379346
            ],
            [
                1714373131026,
                62157.30814063115
            ],
            [
                1714373417368,
                62099.585481593516
            ],
            [
                1714373748372,
                62081.000982014084
            ],
            [
                1714374050916,
                62185.2441394792
            ],
            [
                1714374322784,
                62101.73180628823
            ],
            [
                1714374687680,
                61994.3441523782
            ],
            [
                1714374967990,
                62126.91308529469
            ],
            [
                1714375252820,
                62214.48500060358
            ],
            [
                1714375550355,
                62250.32990104296
            ],
            [
                1714375824249,
                62294.98054006176
            ],
            [
                1714376181554,
                62250.58414633615
            ],
            [
                1714376496623,
                62302.9124175664
            ],
            [
                1714376743688,
                62309.737544083364
            ],
            [
                1714377037024,
                62340.326511784326
            ],
            [
                1714377320891,
                62358.86969191035
            ],
            [
                1714377647529,
                62394.20698451431
            ],
            [
                1714377963805,
                62444.260012947656
            ],
            [
                1714378227839,
                62309.49482100194
            ],
            [
                1714378508521,
                62325.11961884893
            ],
            [
                1714378820567,
                62201.40753533922
            ],
            [
                1714379132226,
                62293.02771208423
            ],
            [
                1714379423128,
                62327.571653706786
            ],
            [
                1714379729961,
                62314.054535543524
            ],
            [
                1714380051125,
                62372.8474447801
            ],
            [
                1714380363478,
                62362.40148682851
            ],
            [
                1714380653803,
                62332.53394897259
            ],
            [
                1714380953854,
                62389.835894069096
            ],
            [
                1714381253229,
                62403.99060765479
            ],
            [
                1714381511534,
                62282.609225164626
            ],
            [
                1714381831636,
                62309.29410594215
            ],
            [
                1714382204111,
                62378.356677161864
            ],
            [
                1714382458958,
                62313.89651341533
            ],
            [
                1714382751844,
                62333.8352330342
            ],
            [
                1714383022282,
                62291.72574821932
            ],
            [
                1714383368376,
                62290.52088115082
            ],
            [
                1714383616366,
                62354.611480884334
            ],
            [
                1714383956386,
                62310.754245651966
            ],
            [
                1714384234603,
                62394.82633565586
            ],
            [
                1714384526161,
                62629.188181913276
            ],
            [
                1714384812470,
                62485.910055382665
            ],
            [
                1714385095158,
                62579.62382607109
            ],
            [
                1714385413645,
                62540.7936585435
            ],
            [
                1714385748999,
                62599.80612066111
            ],
            [
                1714386020564,
                62557.2192983685
            ],
            [
                1714386360028,
                62659.69461598703
            ],
            [
                1714386620289,
                62548.591988358625
            ],
            [
                1714386924265,
                62547.878341214324
            ],
            [
                1714387250086,
                62484.11620603564
            ],
            [
                1714387574691,
                62471.861509224036
            ],
            [
                1714387849291,
                62411.87228797242
            ],
            [
                1714388118872,
                62400.20015001095
            ],
            [
                1714388472149,
                62394.62149157186
            ],
            [
                1714388806954,
                62402.650889779776
            ],
            [
                1714389052487,
                62379.27053449636
            ],
            [
                1714389319659,
                62372.88883978273
            ],
            [
                1714389670120,
                62350.4352520898
            ],
            [
                1714389975427,
                62354.56788848885
            ],
            [
                1714390317890,
                62355.051833044
            ],
            [
                1714390509685,
                62340.37777544096
            ],
            [
                1714390833191,
                62280.61855216372
            ],
            [
                1714391142280,
                62303.623937088305
            ],
            [
                1714391450156,
                62218.15057181717
            ],
            [
                1714391750351,
                62205.966672407434
            ],
            [
                1714392073003,
                62236.95319549425
            ],
            [
                1714392310574,
                62246.832697565944
            ],
            [
                1714392596500,
                62293.93101818714
            ],
            [
                1714392952253,
                62328.42147828829
            ],
            [
                1714393272830,
                62312.91068478307
            ],
            [
                1714393526172,
                62360.28099559506
            ],
            [
                1714393832232,
                62361.241866779725
            ],
            [
                1714394163185,
                62128.54952222602
            ],
            [
                1714394492155,
                62434.653350577864
            ],
            [
                1714394732230,
                62424.95667569814
            ],
            [
                1714395076277,
                62582.931471621276
            ],
            [
                1714395344440,
                62548.42560161328
            ],
            [
                1714395646536,
                62619.52475677046
            ],
            [
                1714395926710,
                62598.36276479947
            ],
            [
                1714396259722,
                62553.49563775417
            ],
            [
                1714396566061,
                62566.86761571401
            ],
            [
                1714396815682,
                62481.30708141092
            ],
            [
                1714397152199,
                62531.05730579538
            ],
            [
                1714397528165,
                62491.288098399185
            ],
            [
                1714397760181,
                62501.571816795346
            ],
            [
                1714398018887,
                62263.79061080135
            ],
            [
                1714398377256,
                61983.95289425813
            ],
            [
                1714398663694,
                61963.5859064079
            ],
            [
                1714398967548,
                61890.499176900696
            ],
            [
                1714399236929,
                61988.375823439164
            ],
            [
                1714399595806,
                62005.29842348035
            ],
            [
                1714399905167,
                62214.23506461014
            ],
            [
                1714400118866,
                62231.3513665966
            ],
            [
                1714400468065,
                62291.72030527544
            ],
            [
                1714400794494,
                62506.63612346643
            ],
            [
                1714401027637,
                62764.913286480136
            ],
            [
                1714401308216,
                62837.723036342664
            ],
            [
                1714401699591,
                62806.778278317266
            ],
            [
                1714401935797,
                62769.6422069632
            ],
            [
                1714402257344,
                62717.94680303227
            ],
            [
                1714402550973,
                62738.60912218499
            ],
            [
                1714402835986,
                62820.97053197032
            ],
            [
                1714403203241,
                62788.543823343985
            ],
            [
                1714403438389,
                62895.86891999867
            ],
            [
                1714403742316,
                62780.73858249143
            ],
            [
                1714404009360,
                62836.31458673513
            ],
            [
                1714404360115,
                62770.30261605025
            ],
            [
                1714404664853,
                62908.52862146638
            ],
            [
                1714404970650,
                62889.03557521579
            ],
            [
                1714405274310,
                62876.76980526223
            ],
            [
                1714405523948,
                62988.86274677735
            ],
            [
                1714405833432,
                63005.684704586776
            ],
            [
                1714406147804,
                62971.45730507119
            ],
            [
                1714406447264,
                62976.48439297888
            ],
            [
                1714406751638,
                63032.97044544069
            ],
            [
                1714407042142,
                63020.71717995186
            ],
            [
                1714407330876,
                63076.17322211493
            ],
            [
                1714407678182,
                63053.353843287754
            ],
            [
                1714407969264,
                62998.39302890946
            ],
            [
                1714408275838,
                62990.878318664305
            ],
            [
                1714408537243,
                62846.21015939224
            ],
            [
                1714408866853,
                62836.63995090423
            ],
            [
                1714409107513,
                62817.77312767851
            ],
            [
                1714409462671,
                62845.49684695761
            ],
            [
                1714409757584,
                62769.84006840589
            ],
            [
                1714410074238,
                62787.086691776465
            ],
            [
                1714410312414,
                62922.67338957337
            ],
            [
                1714410648075,
                62913.39093326489
            ],
            [
                1714410952814,
                62887.48600240458
            ],
            [
                1714411207039,
                63025.62845244697
            ],
            [
                1714411494226,
                62916.73452486477
            ],
            [
                1714411800600,
                63083.97462406638
            ],
            [
                1714412131019,
                63108.77139107321
            ],
            [
                1714412478816,
                62989.98587530813
            ],
            [
                1714412725528,
                62952.53963770951
            ],
            [
                1714413078778,
                62977.652995067634
            ],
            [
                1714413362848,
                63016.88877869227
            ],
            [
                1714413615967,
                63006.186611498175
            ],
            [
                1714413926301,
                62963.686534411594
            ],
            [
                1714414302008,
                62925.54043802451
            ],
            [
                1714414530040,
                62881.95564153367
            ],
            [
                1714414878040,
                62972.824220628885
            ],
            [
                1714415155457,
                62932.090511451934
            ],
            [
                1714415427191,
                62948.32263071918
            ],
            [
                1714415738465,
                62783.70258599618
            ],
            [
                1714416051590,
                62782.56821562403
            ],
            [
                1714416394774,
                62754.23919020323
            ],
            [
                1714416640294,
                62732.29997509387
            ],
            [
                1714416924578,
                62793.46999093124
            ],
            [
                1714417265841,
                62843.297954514936
            ],
            [
                1714417540708,
                62672.64561007628
            ],
            [
                1714417872615,
                62669.572559311404
            ],
            [
                1714418145354,
                62685.76734145556
            ],
            [
                1714418436974,
                62552.91783289709
            ],
            [
                1714418736101,
                62638.43669425248
            ],
            [
                1714419060167,
                62604.72212867592
            ],
            [
                1714419326519,
                62731.14706191915
            ],
            [
                1714419657926,
                62746.01023858346
            ],
            [
                1714419954487,
                62726.871340494166
            ],
            [
                1714420237933,
                62739.3218183554
            ],
            [
                1714420560119,
                62832.74674466646
            ],
            [
                1714420827597,
                62859.29844444232
            ],
            [
                1714421167935,
                62839.2319207648
            ],
            [
                1714421413418,
                63025.67262547294
            ],
            [
                1714421735975,
                63114.303374222174
            ],
            [
                1714422053471,
                63044.69664029935
            ],
            [
                1714422392837,
                63039.101299053385
            ],
            [
                1714422659213,
                62999.71372401159
            ],
            [
                1714422902430,
                63032.48597778527
            ],
            [
                1714423270998,
                63036.09337539996
            ],
            [
                1714423560606,
                63007.49656274857
            ],
            [
                1714423821398,
                62946.737428854634
            ],
            [
                1714424153777,
                62949.04099616328
            ],
            [
                1714424431770,
                62946.58461183008
            ],
            [
                1714424755748,
                62967.264702028544
            ],
            [
                1714425037052,
                62986.05040761662
            ],
            [
                1714425363669,
                62839.87366489434
            ],
            [
                1714425650073,
                62892.57757067346
            ],
            [
                1714425997018,
                62958.85170636796
            ],
            [
                1714426276619,
                62910.57528793265
            ],
            [
                1714426540081,
                62930.62226456634
            ],
            [
                1714426849331,
                62931.6464122245
            ],
            [
                1714427201324,
                62950.17274414142
            ],
            [
                1714427416328,
                62978.04946703156
            ],
            [
                1714427768987,
                63086.82949650304
            ],
            [
                1714428036356,
                63097.385520650096
            ],
            [
                1714428397562,
                63185.037726014954
            ],
            [
                1714428678415,
                63091.695922991916
            ],
            [
                1714428906269,
                63191.58172633411
            ],
            [
                1714429221792,
                63377.196542258585
            ],
            [
                1714429552458,
                63294.77194188093
            ],
            [
                1714429831298,
                63472.46152838112
            ],
            [
                1714430189470,
                63849.865487708776
            ],
            [
                1714430463342,
                63758.07347601487
            ],
            [
                1714430768404,
                63718.13944790071
            ],
            [
                1714431070640,
                63756.06002698612
            ],
            [
                1714431395478,
                63773.887264927944
            ],
            [
                1714431726977,
                63937.2239791095
            ],
            [
                1714431961220,
                63924.68905639166
            ],
            [
                1714432257341,
                64083.319702185654
            ],
            [
                1714432516990,
                63986.07331382951
            ],
            [
                1714432876916,
                64109.78509657424
            ],
            [
                1714433146166,
                64041.797314018084
            ],
            [
                1714433423384,
                63898.67118655903
            ],
            [
                1714433762037,
                63982.79490759213
            ],
            [
                1714434018467,
                63921.478993006065
            ],
            [
                1714434393590,
                63866.96768134842
            ],
            [
                1714434638830,
                63841.25229708315
            ],
            [
                1714434934647,
                63797.67963589958
            ],
            [
                1714435280333,
                63827.108114893235
            ],
            [
                1714435577370,
                63764.30762158292
            ],
            [
                1714435849744,
                63703.86293526543
            ],
            [
                1714436118622,
                63727.66032317258
            ],
            [
                1714436438621,
                63743.06630571404
            ],
            [
                1714436731199,
                63898.49095029147
            ],
            [
                1714437041738,
                63994.589783325086
            ],
            [
                1714437355404,
                63956.237530449536
            ],
            [
                1714437674370,
                63996.88305410464
            ],
            [
                1714437955380,
                64213.69482780932
            ],
            [
                1714438283409,
                64551.7519634495
            ],
            [
                1714438520740,
                64555.01146356184
            ],
            [
                1714438809917,
                64514.6474735241
            ],
            [
                1714439119081,
                64494.16801650694
            ],
            [
                1714439439076,
                64384.50938094816
            ],
            [
                1714439745038,
                64402.76327818694
            ],
            [
                1714440132356,
                64339.073025538324
            ],
            [
                1714440330921,
                64345.33029509867
            ],
            [
                1714440674524,
                64177.29358661456
            ],
            [
                1714440945179,
                64076.48818934327
            ],
            [
                1714441270436,
                64090.654748689405
            ],
            [
                1714441538053,
                64054.28570359253
            ],
            [
                1714441872483,
                64064.64007999549
            ],
            [
                1714442172633,
                64052.4540287461
            ],
            [
                1714442469871,
                63715.578055977
            ],
            [
                1714442720678,
                63150.08808158048
            ],
            [
                1714443038010,
                63425.56982342159
            ],
            [
                1714443310964,
                63398.03556163482
            ],
            [
                1714443658959,
                63604.620071036516
            ],
            [
                1714443954834,
                63655.48162151139
            ],
            [
                1714444307029,
                63578.050194670046
            ],
            [
                1714444596640,
                63767.66354658288
            ],
            [
                1714444883116,
                63819.04258616568
            ],
            [
                1714445141184,
                63776.76075783496
            ],
            [
                1714445461379,
                63797.014048509736
            ],
            [
                1714445704066,
                63800.0747865599
            ],
            [
                1714446015597,
                63786.59739236193
            ],
            [
                1714446380391,
                63638.446830165376
            ],
            [
                1714446691909,
                63631.351631928694
            ],
            [
                1714446971107,
                63539.20324347322
            ],
            [
                1714447317952,
                63579.54156489285
            ],
            [
                1714447570876,
                63660.64413452481
            ],
            [
                1714447875828,
                63734.30714264317
            ],
            [
                1714448147976,
                63781.284159361756
            ],
            [
                1714448444581,
                63634.660810081055
            ],
            [
                1714448756389,
                63625.63604920104
            ],
            [
                1714449026622,
                63628.71173976364
            ],
            [
                1714449357642,
                63681.90038226596
            ],
            [
                1714449630718,
                63613.15319681655
            ],
            [
                1714450005358,
                63614.42080815639
            ],
            [
                1714450259060,
                63677.58225276838
            ],
            [
                1714450512472,
                63622.48854106479
            ],
            [
                1714450866729,
                63536.84922768128
            ],
            [
                1714451162574,
                63516.74785822184
            ],
            [
                1714451459168,
                63494.9366527693
            ],
            [
                1714451753405,
                63474.205725291016
            ],
            [
                1714452073497,
                63504.68296112914
            ],
            [
                1714452322660,
                63520.246817062354
            ],
            [
                1714452642327,
                63474.986254818
            ],
            [
                1714452931775,
                63462.54010889885
            ],
            [
                1714453246794,
                63353.118210687484
            ],
            [
                1714453518495,
                63370.65290547822
            ],
            [
                1714453892288,
                63440.3981179693
            ],
            [
                1714454119902,
                63410.266273344416
            ],
            [
                1714454489277,
                63367.35048740175
            ],
            [
                1714454806307,
                63376.366267861304
            ],
            [
                1714455051032,
                63398.31825584006
            ],
            [
                1714455349954,
                63226.66478922248
            ],
            [
                1714455611000,
                63079.30040029838
            ]
        ]
        let result = points.compactMap { data -> PriceDataPoint? in
            guard
                let date = data.first,
                let price = data.last else { return nil }
            let toDate = Date(timeIntervalSince1970: date / 1000)
            return PriceDataPoint(price: price, date: toDate)
        }
        
        return result
    }
}
